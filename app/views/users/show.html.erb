<%= render 'shared/navbar' %>
<div class="profile-page">
    <div class="profile-container">
        <div class="profile-header">
            <h1 class="profile-title"><%= current_user.username %>'s Profile</h1>
            <div class="profile-buttons">
                <% if current_user.steam_user.present? %>
                    <%= button_to "Disconnect Steam", disconnect_steam_user_path, method: :delete, class: "delete-button", data: { turbo: false } %>
                <% end %>
                <% if current_user.spotify_user.present? %>
                    <%= button_to "Disconnect Spotify", disconnect_spotify_user_path, method: :delete, class: "delete-button", data: { turbo: false } %>
                <% end %>
                <%= button_to "Delete Account", destroy_account_user_path, method: :delete, class: "delete-button", data: { turbo: false, confirm: "Are you sure you want to delete your account? This cannot be undone." } %>
            </div>
        </div>

        <hr class="mb-2">
        
        <div class="profile-content">
            <%= form_with model: current_user, url: user_path, method: :patch, local: true do |form| %>
                <div>
                    <%= form.label :username %>
                    <%= form.text_field :username, class: "input-box" %>
                </div>
                <div>
                    <%= form.label :email %>
                    <%= form.email_field :email, class: "input-box" %>
                </div>
                <div>
                    <%= form.label :password %>
                    <%= form.password_field :password, class: "input-box", autocomplete: "new-password" %>
                </div>
                <div>
                    <%= form.label :password_confirmation %>
                    <%= form.password_field :password_confirmation, class: "input-box", autocomplete: "new-password" %>
                </div>
                <div>
                    <%= form.submit "Edit Profile", class: "btn-primary" %>
                </div>
            <% end %>
            <% flash.each do |key, value| %>
                <% flash_class = case key
                    when "notice" then "flash-notice"
                    when "alert", "error" then "flash-alert"
                    else "flash-notice"
                    end %>
                <div class="<%= flash_class %>"><%= value %></div>
            <% end %>
        </div>
    </div>
</div>
